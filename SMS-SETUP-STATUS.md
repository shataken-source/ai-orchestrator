# üì± SMS Service Setup Status

**Date:** January 3, 2026  
**Status:** ‚è≥ Waiting for Sinch Service to go live in Railway

---

## ‚úÖ Current Implementation

### 1. Daily 8:00 AM Status Text (Jason)
**Status:** ‚úÖ READY

- **Endpoint:** Cron job in `server.js`
- **Schedule:** Daily at 08:00 CST (14:00 UTC)
- **Recipient:** `MY_PHONE_NUMBER` environment variable
- **Function:** `sendCevictBriefing()`
- **Content:** Generated by `generateDailyBriefing()`

**Code Location:**
```javascript
// server.js lines 1147-1160
cron.schedule('0 14 * * *', async () => {
  const briefing = await generateDailyBriefing();
  const result = await sendCevictBriefing(process.env.MY_PHONE_NUMBER, briefing);
}, { timezone: "America/Chicago" });
```

**Test Endpoint:**
```bash
POST /api/test/sms
```

---

### 2. Emergency "Guardian" Alerts (Victoria)
**Status:** ‚úÖ READY (via Project Guardian script)

- **Location:** `Project-Guardian-Cloud.ps1`
- **Trigger:** When Victoria (dog) is found
- **Recipient:** `VICTORIA_PHONE` or `Config.Alerts.PhoneNumber`
- **Method:** SMS via Sinch API

**Code Location:**
```powershell
# Project-Guardian-Cloud.ps1 lines 175-196
if ($Config.Alerts.SMSEnabled -and $env:SINCH_API_TOKEN) {
    $smsBody = @{
        from = $env:SINCH_FROM_NUMBER
        to = @($Config.Alerts.PhoneNumber)
        body = "üêï GUARDIAN ALERT: $Title`n$Message`n$Url"
    }
    Invoke-RestMethod -Uri "https://us.sms.api.sinch.com/xms/v1/$env:SINCH_SERVICE_PLAN_ID/batches" ...
}
```

**Note:** This runs as a separate PowerShell script, not in the orchestrator. It needs:
- `SINCH_API_TOKEN`
- `SINCH_SERVICE_PLAN_ID`
- `SINCH_FROM_NUMBER`
- `VICTORIA_PHONE` or configured phone number

---

### 3. Weekly "Integrity Verified" Hash Report (Navid)
**Status:** ‚ö†Ô∏è NEEDS IMPLEMENTATION

**Current State:**
- Evidence Locker has weekly export functionality
- Email export exists (`/api/legal/email-export`)
- **Missing:** Weekly SMS to Navid with hash

**What Exists:**
- `apps/local-agent/src/api/evidence-locker-routes.ts` - Has email export
- `CEL_DEPLOYMENT_SUMMARY.md` - Documents weekly export
- Evidence export includes SHA-256 hash

**What's Needed:**
1. Add weekly cron job in `server.js`
2. Generate integrity hash from evidence
3. Send SMS to Navid with hash
4. Use `sendCevictBriefing()` function

**Suggested Implementation:**
```javascript
// Add to server.js cron jobs
cron.schedule('0 17 * * 5', async () => { // Friday 5PM CST
  const hash = await generateIntegrityHash();
  const message = `üîí INTEGRITY VERIFIED\n\nWeekly Hash: ${hash}\nDate: ${new Date().toLocaleDateString()}\n\nAll systems verified.`;
  await sendCevictBriefing(process.env.NAVID_PHONE, message);
}, { timezone: "America/Chicago" });
```

---

## üìã Environment Variables Required

### For Daily Briefing (Jason)
```
SINCH_SERVICE_PLAN_ID=5ead1f97ab94481c80d3a52e13de95bb
SINCH_API_TOKEN=78f84e980220406892c2cfccf515e755
SINCH_NUMBER=+12085812971
MY_PHONE_NUMBER=+12562645669
```

### For Guardian Alerts (Victoria)
```
SINCH_SERVICE_PLAN_ID=5ead1f97ab94481c80d3a52e13de95bb
SINCH_API_TOKEN=78f84e980220406892c2cfccf515e755
SINCH_FROM_NUMBER=+12085812971
VICTORIA_PHONE=+1XXXXXXXXXX  # Victoria's phone number
```

### For Integrity Report (Navid) - TO BE ADDED
```
NAVID_PHONE=+1XXXXXXXXXX  # Navid's phone number
```

---

## üöÄ Deployment Checklist

Once Sinch service is live in Railway:

- [x] Daily briefing cron job configured
- [x] SMS function (`sendCevictBriefing`) ready
- [x] Test endpoint (`/api/test/sms`) available
- [x] Guardian alerts script ready (separate)
- [ ] **TODO:** Add weekly integrity hash SMS to Navid
- [ ] **TODO:** Add `NAVID_PHONE` to Railway environment variables
- [ ] **TODO:** Test all three SMS flows

---

## üß™ Testing

### Test Daily Briefing
```bash
curl -X POST "https://ai-orchestrator-production-7bbf.up.railway.app/api/test/sms" \
  -H "x-admin-key: 84f08fc8449510e4839aa899a708413822fa7fe34abfc027df90aa4246afb7cb" \
  -H "Content-Type: application/json"
```

### Test Guardian Alert
Run the Project Guardian script or trigger manually via the script's alert function.

### Test Integrity Report
Once implemented, test via cron job or manual trigger.

---

## üìù Next Steps

1. **Wait for Sinch service to go live** ‚úÖ (You're doing this)
2. **Add weekly integrity hash SMS** (Needs implementation)
3. **Add Navid's phone to environment variables**
4. **Test all three SMS flows once live**

---

**Status:** Ready to activate once Sinch service is live! üöÄ

